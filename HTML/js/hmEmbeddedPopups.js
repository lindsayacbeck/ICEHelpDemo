/*! Help & Manual WebHelp 3 Script functions
Copyright (c) 2014 - 2015 by Tim Green. All rights reserved. Contact tg@it-authoring.com
*/
var scriptEls=document.getElementsByTagName("script"),thisScriptEl=scriptEls[scriptEls.length-1],scriptPath=thisScriptEl.src,hmPopupPath=scriptPath.substr(0,scriptPath.lastIndexOf("/js/")+1);var hmXPopup={};var doHmXPopup=function(){hmXPopup.PreventDefault=function(o){if(typeof o=="undefined"||o==null){return}(o.preventDefault)?o.preventDefault():o.returnValue=false};if($("link#popupstyles").length<1){$("head").append('<link id="popupstyles" rel="stylesheet" type="text/css" href="'+hmPopupPath+'css/hm_popup.css" />')}var f=navigator.userAgent,d=navigator.platform;hmXPopup.hmBrowser={};hmXPopup.hmBrowser.touch=!!(("ontouchstart" in window)||("msmaxtouchpoints" in window.navigator)||("maxtouchpoints" in window.navigator)||(navigator.maxTouchPoints>0)||(navigator.msMaxTouchPoints>0));hmXPopup.hmBrowser.nonDeskTouch=!!((hmXPopup.hmBrowser.touch&&!/win32/i.test(d))||(hmXPopup.hmBrowser.touch&&/win32/i.test(d)&&/mobile/i.test(f)));hmXPopup.hmBrowser.eventType=(("onmousedown" in window&&!hmXPopup.hmBrowser.nonDeskTouch)?"mouse":("ontouchstart" in window)?"touch":("msmaxtouchpoints" in window.navigator||navigator.msMaxTouchPoints>0)?"mstouchpoints":("maxtouchpoints" in window.navigator||navigator.maxTouchPoints>0)?"touchpoints":"mouse");switch(hmXPopup.hmBrowser.eventType){case"mouse":hmXPopup.hmBrowser.touchstart="mousedown.startevents";hmXPopup.hmBrowser.touchend="mouseup.endevents";hmXPopup.hmBrowser.touchmove="mousemove.moveevents";break;case"touch":hmXPopup.hmBrowser.touchstart="touchstart.startevents";hmXPopup.hmBrowser.touchend="touchend.endevents";hmXPopup.hmBrowser.touchmove="touchmove.moveevents";break;case"mstouchpoints":hmXPopup.hmBrowser.touchstart="MSPointerDown.startevents";hmXPopup.hmBrowser.touchend="MSPointerUp.endevents";hmXPopup.hmBrowser.touchmove="MSPointerMove.moveevents";break;case"touchpoints":hmXPopup.hmBrowser.touchstart="pointerdown.startevents";hmXPopup.hmBrowser.touchend="pointerup.endevents";hmXPopup.hmBrowser.touchmove="pointermove.moveevents";break}hmXPopup.hmDevice={};hmXPopup.hmDevice.agent=navigator.userAgent.toLowerCase();hmXPopup.hmDevice.platform=navigator.platform.toLowerCase();hmXPopup.hmDevice.ipad=/ipad/.test(hmXPopup.hmDevice.platform);hmXPopup.hmDevice.iphone=/iphone/.test(hmXPopup.hmDevice.platform);hmXPopup.hmDevice.winphone7=(/windows phone os [7]\.\d\d??; .*?trident\/[5]\.\d\d??; iemobile\/9/.test(hmXPopup.hmDevice.agent));hmXPopup.hmDevice.winphone=(/windows phone [89]\.\d\d??; .*?trident\/[67]\.\d\d??;.*?touch; /.test(hmXPopup.hmDevice.agent));hmXPopup.hmDevice.w8desktop=(/windows nt 6\.[2345]|windows nt 10\.[0123456]/m.test(hmXPopup.hmDevice.agent));hmXPopup.hmDevice.msBrowser=(/edge|trident/m.test(hmXPopup.hmDevice.agent));hmXPopup.hmDevice.w8metro=(function(){var o=true;try{new ActiveXObject("htmlfile")}catch(p){o=false}return(!o&&hmXPopup.hmDevice.w8desktop&&hmXPopup.hmDevice.msBrowser)})();hmXPopup.hmDevice.touch=!!(("ontouchstart" in window&&!window.opera)||("msmaxtouchppoints" in window.navigator)||("maxtouchppoints" in window.navigator)||(navigator.maxTouchPoints>0)||(navigator.msMaxTouchPoints>0));hmXPopup.hmDevice.tb=(/tablet/.test(hmXPopup.hmDevice.agent)&&(!/trident/.test(hmXPopup.hmDevice.agent)||(hmXPopup.hmDevice.w8metro&&hmXPopup.hmDevice.touch)));hmXPopup.hmDevice.goodandroid=(/android.+?applewebkit\/(?:(?:537\.(?:3[6-9]|[4-9][0-9]))|(?:53[8-9]\.[0-9][0-9])|(?:54[0-9]\.[0-9][0-9]))|android.+?gecko\/[345][0-9]\.\d{1,2} firefox/.test(hmXPopup.hmDevice.agent));hmXPopup.hmDevice.deadandroid=(/android.+?applewebkit\/(?:53[0-6]\.\d{1,2})|firefox\/[0-2]\d\.\d{1,2}/.test(hmXPopup.hmDevice.agent));hmXPopup.hmDevice.android=(/android/.test(hmXPopup.hmDevice.agent)&&!hmXPopup.hmDevice.deadandroid);hmXPopup.hmDevice.mb=/mobi|mobile/.test(hmXPopup.hmDevice.agent);hmXPopup.hmDevice.phone=(hmXPopup.hmDevice.mb&&!hmXPopup.hmDevice.ipad&&!hmXPopup.hmDevice.tb);hmXPopup.hmDevice.tablet=(hmXPopup.hmDevice.ipad||hmXPopup.hmDevice.tb||(!hmXPopup.hmDevice.phone&&hmXPopup.hmDevice.android));hmXPopup.hmDevice.aspectRatio=(screen.height/screen.width>1?screen.height/screen.width:screen.width/screen.height).toFixed(2);hmXPopup.hmDevice.narrowTablet=(hmXPopup.hmDevice.tablet&&hmXPopup.hmDevice.aspectRatio>1.4);hmXPopup.hmDevice.desktop=((!hmXPopup.hmDevice.tablet&&!hmXPopup.hmDevice.phone));hmXPopup.hmDevice.device=hmXPopup.hmDevice.phone?"phone":hmXPopup.tablet?"tablet":hmXPopup.hmDevice.desktop?"desktop":"default";var n=$("body");n.prepend('<div id="hmpopupbox" class="hmpopup"><div id="hmpopuptitlebar" class="hmpopup"><div id="hmpopuptitle"  class="hmpopup"><p class="hmpopup">This is the title bar</p></div><div id="hmclosepopup" class="hmpopup"><span>X</span></div></div><div id="hmpopupbody"><iframe id="hmXPopupFrame" src="" class="hmpopup" frameborder="0"></iframe></div></div>');n.prepend('<div id="dragsurface" style="display: none; position: fixed; top: 0; right: 0; bottom: 0; left: 0; background-image: url(\''+hmPopupPath+"images/spacer.gif')\" />");hmXPopup.$popup=$("div#hmpopupbox");hmXPopup.$popuptitle=$("div#hmpopuptitle > p");hmXPopup.$popupheader=$("div#hmpopuptitlebar");hmXPopup.$popupdragger=$("div#hmpopuptitle");hmXPopup.$dragsurface=$("div#dragsurface");hmXPopup.$popupbody=null;hmXPopup.$popupscroller=null;hmXPopup.$popupwindow=null;hmXPopup.$popframe=$("iframe#hmXPopupFrame");hmXPopup.refPath="./";hmXPopup.clickX=0;hmXPopup.clickY=0;hmXPopup.relposX=0;hmXPopup.relposY=0;hmXPopup.hmResizePopup=function(){var q=0,u=0,r=function(){return $(window).width()},y=0,s=0,p=function(){return $(window).height()},w=0,z=0,t=0,o=0,x=function(){return hmXPopup.$popupscroller.height()>hmXPopup.$popupwindow.height()},v=function(){return hmXPopup.$popupscroller.width()>hmXPopup.$popupwindow.width()};q=hmXPopup.$popupbody.outerWidth(true);u=hmXPopup.$popupbody.outerHeight(true);if(v()){hmXPopup.$popup.width((hmXPopup.$popupscroller.width()+10)+"px")}if(x()){t=hmXPopup.$popup.width();o=hmXPopup.$popup.height();do{t+=5;o+=5;hmXPopup.$popup.width(t+"px");hmXPopup.$popup.height(o+"px")}while(x()&&(t<r()*0.5));if(v()){hmXPopup.$popup.width((hmXPopup.$popupscroller.width()+5)+"px")}if(x()){hmXPopup.$popup.height((hmXPopup.$popupheader.height()+hmXPopup.$popupscroller.height()+2)+"px")}}y=r()-5;s=hmXPopup.$popup.outerWidth();w=p()-5;z=hmXPopup.$popup.outerHeight();if((z+hmXPopup.relposY+15<w-5)&&(s+hmXPopup.relposX+30<y-5)){hmXPopup.clickY+=15;hmXPopup.clickX+=30}else{if(z+hmXPopup.relposY+15>w-5){hmXPopup.clickY=$(document).scrollTop()+(w-z);hmXPopup.clickY=hmXPopup.clickY<0?5:hmXPopup.clickY}else{hmXPopup.clickY+=15}if(s+hmXPopup.relposX+30>y-5){if(s+5<hmXPopup.relposX){hmXPopup.clickX=$(document).scrollLeft()+(y-s)}else{hmXPopup.clickX=($(document).scrollLeft()+y)-(s+5)}hmXPopup.clickX=hmXPopup.clickX<0?5:hmXPopup.clickX}else{hmXPopup.clickX+=30}}hmXPopup.$popup.css({top:(hmXPopup.clickY)+"px",left:(hmXPopup.clickX)+"px"})};hmLoadPopup=function(o){hmXPopup.noresize=false;if(hmXPopup.$popframe.attr("src")==""){hmXPopup.$popframe.attr("src",hmXPopup.refPath+"_hmXpopup.htm")}var p=setInterval(function(){hmXPopup.$popupbody=hmXPopup.$popframe.contents().find("div#hmxpopupbody");if(hmXPopup.$popupbody.length>0){clearInterval(p);hmXPopup.$popupscroller=hmXPopup.$popframe.contents().find("body");hmXPopup.$popupwindow=$("div#hmpopupbody");hmXPopup.$popupbody.html(o.hmBody);hmXPopup.$popuptitle.html(o.hmTitle);hmXPopup.$popup.css({height:"3.6rem",width:"20rem"});hmXPopup.$popup.show();hmXPopup.hmResizePopup();if(hmXPopup.hmDevice.desktop&&!hmXPopup.noresize){$("body").on("mousemove.resizepopuplistener",function(r){var q=r.originalEvent;hmXPopup.resizeListener(q)});$("body").on("mousedown.resizepopup",function(q){var r=q.originalEvent;hmXPopup.startResizePopup(r)})}}},30)};hmXPopup.closePopup=function(){hmXPopup.$popup.fadeOut(300);if(hmXPopup.hmDevice.desktop){$("body").off(".resizepopup").off(".resizepopuplistener");hmXPopup.$dragsurface.off(".resizepopup")}hmXPopup.$popupbody.find("iframe").attr("src","");var o=hmXPopup.$popupbody.find("object,embed,param");if(o.length>0){if(/trident|edge/i.test(window.navigator.userAgent)){document.location.reload()}else{o.attr("data","").attr("src","").attr("value","").remove()}}hmXPopup.$popup.attr("style","");hmXPopup.$popupbody.html("");j()};hmXPopup.loadPopup=function(p,o){if(typeof o!=="undefined"){hmXPopup.refPath=o}var q=hmXPopup.refPath+"jspopups/"+p;$.getScript(q,function(r,t,s){})};$("a.hmpopuplink,a.popuphotspot,a.topichotspot[href^='javascript:void']").on("click",function(p){p.preventDefault();hmXPopup.clickX=p.pageX;hmXPopup.relposX=hmXPopup.clickX-$(document).scrollLeft();hmXPopup.clickY=p.pageY;hmXPopup.relposY=hmXPopup.clickY-$(document).scrollTop();var o=$(this).attr("data-target");hmXPopup.loadPopup(o,hmPopupPath)});$("div#hmclosepopup").on(hmXPopup.hmBrowser.touchstart,hmXPopup.closePopup);var c=0,e=0,i=0,m,l,b,h;var a=function(o){if(o.pointerType=="mouse"||o.pointerType==4){return"mouse"}else{if(o.pointerType=="touch"||o.pointerType==2||o.pointerType=="pen"||o.pointerType==3){return"touch"}else{if(/^mouse/i.test(o.type)){return"mouse"}else{if(/^touch/i.test(o.type)||/^pen/i.test(o.type)){return"touch"}else{return"none"}}}}};var j=function(o){e=new Date().getTime()-c;if(e<200){}hmXPopup.$popupdragger.off(".endevents");hmXPopup.$popupdragger.off(".moveevents");hmXPopup.$dragsurface.off(".endevents");hmXPopup.$dragsurface.off(".moveevents");hmXPopup.$dragsurface.hide().css("cursor","default");hmXPopup.PreventDefault(o)};var k=function(r){e=new Date().getTime()-c;if(e<50){return}var p;if(typeof r.changedTouches!="undefined"){p=r.changedTouches[0]}else{p=r}i++;if(hmXPopup.hmDevice.desktop||i>2){i=0;var q=(!(document.all&&!window.opera))?p.pageX-m:p.clientX-m;var o=(!(document.all&&!window.opera))?p.pageY-l:p.clientY-l;hmXPopup.$popup.css({left:(b+q)+"px"});hmXPopup.$popup.css({top:(h+o)+"px"})}};var g=function(p){hmXPopup.PreventDefault(p);c=new Date().getTime();if(typeof p.changedTouches!="undefined"){var o=p.changedTouches[0]}else{var o=p}m=(!(document.all&&!window.opera))?o.pageX:o.clientX;l=(!(document.all&&!window.opera))?o.pageY:o.clientY;b=hmXPopup.$popup.position().left;h=hmXPopup.$popup.position().top;if(hmXPopup.hmBrowser.touch||hmXPopup.hmDevice.winphone||a(p)=="mouse"){hmXPopup.$dragsurface.css("cursor","all-scroll").show();hmXPopup.$dragsurface.on(hmXPopup.hmBrowser.touchmove,function(r){var q=r.originalEvent;k(q)});hmXPopup.$dragsurface.on(hmXPopup.hmBrowser.touchend,function(r){var q=r.originalEvent;j(q)})}hmXPopup.$popupdragger.on(hmXPopup.hmBrowser.touchmove,function(r){var q=r.originalEvent;k(q)});hmXPopup.$popupdragger.on(hmXPopup.hmBrowser.touchend,function(r){var q=r.originalEvent;j(q)})};hmXPopup.$popupdragger.on(hmXPopup.hmBrowser.touchstart,function(p){var o=p.originalEvent;g(o)});if(hmXPopup.hmDevice.desktop){hmXPopup.resizeListener=function(v){var t=hmXPopup.$popup.position(),u=hmXPopup.$popup.outerWidth(),s=hmXPopup.$popup.outerHeight(),p=2;hmXPopup.ewResize="ew-resize";hmXPopup.nsResize="ns-resize";var q=((v.pageX>(t.left+(u-4)))&&(v.pageX<(t.left+u+8))&&(v.pageY>t.top)&&(v.pageY<t.top+ +s+8));var o=((v.pageY>(t.top+(s-8-p)))&&(v.pageY<(t.top+s+10))&&(v.pageX<(t.left+u+10))&&(v.pageX>t.left+4));var r=((q&&(v.pageY>(t.top+s-10)))||(o&&v.pageX>(t.left+u-10)));hmXPopup.bdDrag=q||o;$("body").css("cursor",function(){return r?"nw-resize":q&&!o?hmXPopup.ewResize:o&&!q?hmXPopup.nsResize:"auto"})};hmXPopup.deSelect=function(){if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}return false};hmXPopup.doResizePopup=function(q,s){hmXPopup.deSelect();var p=q.pageX-hmXPopup.resizeX,o=q.pageY-hmXPopup.resizeY,t=hmXPopup.popdims.w+p,r=hmXPopup.popdims.h+o;switch(s){case"horizontal":r=hmXPopup.popdims.h;break;case"vertical":t=hmXPopup.popdims.w;break}if(r<50){r=50}if(t<200){t=200}hmXPopup.$popup.css({width:t+"px","max-width":t+"px",height:r+"px","max-height":r+"px"})};hmXPopup.endResizePopup=function(o){hmXPopup.$dragsurface.off("mousemove.resizepopup");$("body").off("mouseup.resizepopup");hmXPopup.$popupbody.css("overflow","auto");$("body").css("cursor","default");hmXPopup.$dragsurface.css("cursor","default").hide()};hmXPopup.startResizePopup=function(q){var p=$("body").css("cursor");function o(r){hmXPopup.resizeX=q.pageX;hmXPopup.resizeY=q.pageY;hmXPopup.$popupbody.css("overflow","hidden");hmXPopup.popdims={};hmXPopup.popdims.w=hmXPopup.$popup.width();hmXPopup.popdims.h=hmXPopup.$popup.height();$("body").on("mouseup.resizepopup",function(s){var t=s.orginalEvent;hmXPopup.endResizePopup(t)});hmXPopup.$dragsurface.css("cursor",p);$("body").css("cursor",p);hmXPopup.$dragsurface.show().on("mousemove.resizepopup",function(s){var t=s.originalEvent;hmXPopup.doResizePopup(t,r)})}switch(p){case"ew-resize":o("horizontal");break;case"nw-resize":o("diagonal");break;case"ns-resize":o("vertical");break}}}};if(typeof jQuery==="undefined"){var jQ=document.createElement("script");jQ.setAttribute("type","text/javascript");jQ.setAttribute("src",hmPopupPath+"js/jquery.js");document.getElementsByTagName("head")[0].appendChild(jQ);var jQLoader=setInterval(function(){if(typeof $==="function"){clearInterval(jQLoader);doHmXPopup()}},50)}else{doHmXPopup()};
